!function e(t,n,i){function o(r,u){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!u&&l)return l(r,!0);if(a)return a(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var p=n[r]={exports:{}};t[r][0].call(p.exports,function(e){var n=t[r][1][e];return o(n?n:e)},p,p.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t,n){(function(t){"use strict";!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof n?"undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null:jQuery)}(function(t){{var n=e("./widgets/Booking");e("./widgets/Signup")}t.fn.copaairBooking=function(e){return this.each(function(){t.data(this,"plugin_copaairBooking")||t.data(this,"plugin_copaairBooking",new n(this,e))})}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./widgets/Booking":3,"./widgets/Signup":4}],2:[function(e,t){(function(e){"use strict";var n=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o="undefined"!=typeof window?window.$:"undefined"!=typeof e?e.$:null,a={departureSelector:".copaair-booking-datepicker-departure",returnSelector:".copaair-booking-datepicker-return",dateRules:{today:new Date,weekLater:new Date((new Date).getTime()+6048e5)}},r=function(){function e(t,n){i(this,e),this.options=o.extend({},a,n),this._defaults=a,this.formElement=t}return n(e,null,{render:{value:function(){this.setDefaultDates()},writable:!0,configurable:!0},setDefaultDates:{value:function(){var e=this.options.dateRules,t=o(this.options.departureSelector),n=o(this.options.returnSelector);t.datepicker({minDate:new Date}),n.datepicker({minDate:new Date}),t.datepicker("setDate",e.today),n.datepicker("setDate",e.weekLater)},writable:!0,configurable:!0},setLocale:{value:function(){o.datepicker.setDefaults(regional)},writable:!0,configurable:!0}}),e}();t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t){(function(n){"use strict";var i=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,r=e("../lib/Datepicker"),u={lang:"es",origin:"all",destination:"all",templatePath:"bower_components/copaair-widgets/templates/booking.hbs",languagePath:"bower_components/copaair-widgets/language/",formUrl:"https://bookings.copaair.com/CMGS/AirLowFareSearchExternal.do?"},l={allDestinations:"https://copaapi.nbxapps.com/destinations/",countryDestinations:"https://copaapi.nbxapps.com/destinations/?country="},s=function(){function e(t,n){var i=this;o(this,e),this.$booking=a(t),this.options=a.extend({},u,n),this._defaults=u,a.getJSON(this.options.languagePath+this.options.lang+".json",function(e){i.languageStrings=e,i.compileTemplate(function(){i.setupSelectMenus(),i.setupAutocomplete();var e=new r;e.render(),i.setFormValues(e),i.datepickerFormEvents(e)})})}return i(e,null,{compileTemplate:{value:function(e){var t=this;return"undefined"!=typeof Handlebars&&null!==Handlebars?a.ajax({url:this.options.templatePath,success:function(e){var n=Handlebars.compile(e),i=n(t.languageStrings);t.$booking.html(i)},complete:function(){"function"==typeof e&&e()}}):console.error("This plugin requires Handlebars.js"),this},writable:!0,configurable:!0},setupSelectMenus:{value:function(){return a(".js-selectmenu").selectmenu(),this},writable:!0,configurable:!0},setupAutocomplete:{value:function(){var e=this;return this.fetchDestinations(function(){e.buildAutocomplete(function(){console.log("boomshakalaka")})}),this},writable:!0,configurable:!0},fetchDestinations:{value:function(e){var t=this,n=l.allDestinations,i=this.options.lang;return this.destinations=[],a.getJSON(n,function(n){n.sort(function(e,t){return e.name[i]>t.name[i]?1:e.name[i]<t.name[i]?-1:0});var o=[];a.each(n,function(e,t){var n="<b>"+t.name[i]+", "+t.country+'</b><span class="code"> | '+t.id+"</span>",a=t.id,r=t.name[i]+", "+t.id;o.push({label:n,value:a,display:r})}),t.destinations=o,"function"==typeof e&&e()}),this},writable:!0,configurable:!0},buildAutocomplete:{value:function(e){var t=this;return this.$booking.find(".js-booking-autocomplete").each(function(){var e=a(this).hide(),n=e.val(),i=e.attr("placeholder"),o=e.data("input-field"),r=a("<input />").val(n).attr("type","text").attr("placeholder",i);r.autocomplete({delay:0,minLength:0,appendTo:t.$booking,source:t.destinations,select:function(e,t){return r.val(t.item.display),"origin"===o||"destination"===o?(a(".js-"+o+"-input-outbound").val(t.item.value),a(".js-"+o+"-input-inbound").val(t.item.value)):console.log("The form needs two trip type inputs: origin and destination"),!1}}),r.addClass("copaair-booking-control  copaair-booking-combobox-input").addClass("ui-widget  ui-widget-content  ui-state-default"),r.insertAfter(e),r.autocomplete("instance")._renderItem=function(e,t){return a("<li>").append(t.label).appendTo(e)},a.ui.autocomplete.filter=function(e,t){var n=new RegExp("\\b"+a.ui.autocomplete.escapeRegex(t),"i");return a.grep(e,function(e){return n.test(e.label||e.value||e)})}}),"function"==typeof e&&e(),this},writable:!0,configurable:!0},bookingEvents:{value:function(){var e=a(".copaair-booking");this.submitForm(e)},writable:!0,configurable:!0},setFormValues:{value:function(e){var t=this.$booking,n=a(e.options.departureSelector).datepicker("getDate"),i=a(e.options.returnSelector).datepicker("getDate");t.find('input[name="inboundOption.departureDay"]').attr("value",i.getUTCDate()),t.find('input[name="inboundOption.departureMonth"]').attr("value",i.getMonth()+1),t.find('input[name="inboundOption.departureYear"]').attr("value",i.getFullYear()),t.find('input[name="outboundOption.departureDay"]').attr("value",n.getUTCDate()),t.find('input[name="outboundOption.departureMonth"]').attr("value",n.getMonth()+1),t.find('input[name="outboundOption.departureYear"]').attr("value",n.getFullYear())},writable:!0,configurable:!0},datepickerFormEvents:{value:function(e){var t=a(e.options.departureSelector),n=a(e.options.returnSelector),i=this.$booking,o=function(e,t){var o=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),a=new Date(o.getTime()+6048e5);n.datepicker("setDate",a),i.find('input[name="inboundOption.departureDay"]').attr("value",a.getUTCDate()),i.find('input[name="inboundOption.departureMonth"]').attr("value",a.getMonth()+1),i.find('input[name="inboundOption.departureYear"]').attr("value",a.getFullYear()),n.datepicker("option","minDate",o),i.find('input[name="outboundOption.departureDay"]').attr("value",t.selectedDay),i.find('input[name="outboundOption.departureMonth"]').attr("value",t.selectedMonth+1),i.find('input[name="outboundOption.departureYear"]').attr("value",t.selectedYear)},r=function(e,t){i.find('input[name="inboundOption.departureDay"]').attr("value",t.selectedDay),i.find('input[name="inboundOption.departureMonth"]').attr("value",t.selectedMonth+1),i.find('input[name="inboundOption.departureYear"]').attr("value",t.selectedYear)};t.datepicker("option","onSelect",o),n.datepicker("option","onSelect",r)},writable:!0,configurable:!0},submitForm:{value:function(e){var t=this;e.on("submit",function(n){n.preventDefault();var i=a(this).serialize(),o=t.options.formUrl;if(t.validationError(e))console.log("error in the form");else{var r=window.open(o+i,"_blank");r.focus()}})},writable:!0,configurable:!0}}),e}();t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/Datepicker":2}],4:[function(){"use strict"},{}]},{},[1]);
//# sourceMappingURL=copaair-widgets.min.js.map